<!-- Titre en haut de la page -->
{% load static %}

<!DOCTYPE html>
<html lang="fr">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href=" {% static 'style.css' %}">
    <link rel="stylesheet" href=" {% static 'css/bootstrap.min.css' %}">

    </head>
    <body>
  

    <div id="content">
        <!-- Contenu de la page -->
    </div>
    <script>src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"</script>
    <script>
    let isLoading = false;
       
    function loadContent() {
    console.log(isLoading);
    // Empêcher le chargement multiple
    if (isLoading) return; // Ne pas exécuter si une action de navigation est déjà en cours
    isLoading = true;


    // Mettre à jour l'URL sans recharger la page
    history.replaceState({}, '', location.hash);


        var hash = location.hash;
        console.log("Hash changed to:", hash);
        var content = document.getElementById('content');
        var url = '';
    
        switch(hash) {
            case '#index':
                url = 'index/';
                break;
            case '#welcome':
                url = 'welcome/';
                break;
            case "#games":
                url = "games/";
                break;
            case '#AI':
                url = 'AI/';
                break;
            case '#login':
                url = 'login/';
                break;
            case '#register':
                url = 'register/';
                break;
            default:
                url = 'index/';
        }
    
        // Utiliser AJAX pour récupérer le contenu
        var xhr = new XMLHttpRequest();
        console.log("URL " + url);
        xhr.open('GET', url, true);
        xhr.onload = function() {
            if (this.status >= 200 && this.status < 400) {
                // Insérer le contenu récupéré dans l'élément 'content'
                content.innerHTML = "";
                content.innerHTML = this.responseText;

                // Créer une nouvelle balise <script>
                var script = document.createElement('script');
    
                // Load the appropriate script based on the URL hash
                switch(hash) {
                    case '#index':
                        console.log("Loading index.js");
                        script.src = "{% static 'index.js' %}";
                        break;
                    case '#connection':
                        console.log("Loading welcome.js");
                        script.src = "{% static 'welcome.js' %}";
                        break;
                    case '#register':
                        console.log("Loading register.js");
                        script.src = "{% static 'register.js' %}";
                        break;
                    case '#login':
                        console.log("Loading login.js");
                        script.src = "{% static 'login.js' %}";
                        break;
                    case "#AI":
                        console.log("Loading AI.js");
                        script.src =  "{% static 'AI.js' %}"; 
                        break;

                }

                // Ajouter le script à la page après un court délai
                setTimeout(function() {
                    document.head.appendChild(script);
                }, 500);

                    isLoading = false;
                }
                 else {
                // Gérer les erreurs
                content.innerHTML = 'Erreur lors du chargement de la section.';
                isLoading = false;
            }
        };
        xhr.onerror = function() {
            // Gérer les erreurs de réseau
            content.innerHTML = 'Erreur de réseau.';

        };
        xhr.send();

    }
    
    // Écouter l'événement hashchange
    window.addEventListener('hashchange', loadContent);

    // Écouter l'événement popstate pour gérer le retour et le précédent
    window.addEventListener('popstate', loadContent);

    
    // Charger le contenu au chargement initial de la page
    document.addEventListener('DOMContentLoaded', loadContent);

    </script>
    </body>
</html> 